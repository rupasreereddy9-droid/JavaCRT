package project;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class ExampleForStatements {

    public static void main(String[] args) {

        String jdbcurl = "jdbc:mysql://localhost:3306/crt";
        String username = "root";
        String password = "Rupa@1927";

        try {
            
            Connection c = DriverManager.getConnection(jdbcurl, username, password);
            Statement s = c.createStatement();

            // Create table (run only once)
            /*
            String createTable = "CREATE TABLE user (" +
                                 "id INT PRIMARY KEY, " +
                                 "name VARCHAR(255) NOT NULL)";
            s.execute(createTable);
            System.out.println("Table created successfully");
            

            // Insert data
            String insertData = "INSERT INTO user(id, name) VALUES (1,'rupa'), (2,'dhanu')";
            int rowsAffected = s.executeUpdate(insertData);
            System.out.println(rowsAffected + " records inserted successfully");

            // Retrieve data
            String retrieveData = "SELECT * FROM user";
            ResultSet rs = s.executeQuery(retrieveData);

            System.out.println("ID\tName");
            while (rs.next()) {
                System.out.println(rs.getInt("id") + "\t" + rs.getString("name"));
            } */
            
            // Close resources
            String retrieve="SELECT firstname,lastname,email FROM student";
        	ResultSet result=s.executeQuery(retrieve);
        	while(result.next())
        	{
        		String firstName=result.getString("firstName");
        		String lastName=result.getString("lastName");
        		String email=result.getString("email");
        		System.out.println("First Name: "+firstName+",Last Name :" +lastName+",Email :"+email);
        	}
            s.close();
            c.close();
        } 
        catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
  


